{"version":3,"file":"table-detail.vue_vue_type_script_setup_true_lang.07735409.js","sources":["../../src/components/table-edit.vue","../../src/components/table-detail.vue"],"sourcesContent":["<template>\r\n\t<el-form ref=\"formRef\" :model=\"form\" :rules=\"rules\" :label-width=\"options.labelWidth\">\r\n\t\t<el-row>\r\n\t\t\t<el-col :span=\"options.span\" v-for=\"item in options.list\">\r\n\t\t\t\t<el-form-item :label=\"item.label\" :prop=\"item.prop\">\r\n\t\t\t\t\t<!-- 文本框、数字框、下拉框、日期框、开关、上传 -->\r\n\t\t\t\t\t<el-input v-if=\"item.type === 'input'\" v-model=\"form[item.prop]\" :disabled=\"item.disabled\"\r\n\t\t\t\t\t\t:placeholder=\"item.placeholder\" clearable></el-input>\r\n\t\t\t\t\t<el-input-number v-else-if=\"item.type === 'number'\" v-model=\"form[item.prop]\"\r\n\t\t\t\t\t\t:disabled=\"item.disabled\" controls-position=\"right\"></el-input-number>\r\n\t\t\t\t\t<el-select v-else-if=\"item.type === 'select'\" v-model=\"form[item.prop]\" :disabled=\"item.disabled\"\r\n\t\t\t\t\t\t:placeholder=\"item.placeholder\" clearable>\r\n\t\t\t\t\t\t<el-option v-for=\"opt in item.opts\" :label=\"opt.label\" :value=\"opt.value\"></el-option>\r\n\t\t\t\t\t</el-select>\r\n\t\t\t\t\t<el-date-picker v-else-if=\"item.type === 'date'\" type=\"date\" v-model=\"form[item.prop]\"\r\n\t\t\t\t\t\t:value-format=\"item.format\"></el-date-picker>\r\n\t\t\t\t\t<el-switch v-else-if=\"item.type === 'switch'\" v-model=\"form[item.prop]\"\r\n\t\t\t\t\t\t:active-value=\"item.activeValue\" :inactive-value=\"item.inactiveValue\"\r\n\t\t\t\t\t\t:active-text=\"item.activeText\" :inactive-text=\"item.inactiveText\"></el-switch>\r\n\t\t\t\t\t<el-upload v-else-if=\"item.type === 'upload'\" class=\"avatar-uploader\" action=\"#\"\r\n\t\t\t\t\t\t:show-file-list=\"false\" :on-success=\"handleAvatarSuccess\">\r\n\t\t\t\t\t\t<img v-if=\"form[item.prop]\" :src=\"form[item.prop]\" class=\"avatar\" />\r\n\t\t\t\t\t\t<el-icon v-else class=\"avatar-uploader-icon\">\r\n\t\t\t\t\t\t\t<Plus />\r\n\t\t\t\t\t\t</el-icon>\r\n\t\t\t\t\t</el-upload>\r\n\t\t\t\t\t<slot :name=\"item.prop\" v-else>\r\n\r\n\t\t\t\t\t</slot>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t</el-col>\r\n\t\t</el-row>\r\n\r\n\t\t<el-form-item>\r\n\t\t\t<el-button type=\"primary\" @click=\"saveEdit(formRef)\">保 存</el-button>\r\n\t\t</el-form-item>\r\n\t</el-form>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport { FormOption } from '@/types/form-option';\r\nimport { FormInstance, FormRules, UploadProps } from 'element-plus';\r\nimport { PropType, ref } from 'vue';\r\n\r\nconst { options, formData, edit, update } = defineProps({\r\n\toptions: {\r\n\t\ttype: Object as PropType<FormOption>,\r\n\t\trequired: true\r\n\t},\r\n\tformData: {\r\n\t\ttype: Object,\r\n\t\trequired: true\r\n\t},\r\n\tedit: {\r\n\t\ttype: Boolean,\r\n\t\trequired: false\r\n\t},\r\n\tupdate: {\r\n\t\ttype: Function,\r\n\t\trequired: true\r\n\t}\r\n});\r\n\r\n\r\nconst form = ref({ ...(edit ? formData : {}) });\r\n\r\nconst rules: FormRules = options.list.map(item => {\r\n\tif (item.required) {\r\n\t\treturn { [item.prop]: [{ required: true, message: `${item.label}不能为空`, trigger: 'blur' }] };\r\n\t}\r\n\treturn {};\r\n}).reduce((acc, cur) => ({ ...acc, ...cur }), {});\r\n\r\n\r\nconst formRef = ref<FormInstance>();\r\nconst saveEdit = (formEl: FormInstance | undefined) => {\r\n\tif (!formEl) return;\r\n\tformEl.validate(valid => {\r\n\t\tif (!valid) return false;\r\n\t\tupdate(form.value);\r\n\t});\r\n};\r\n\r\nconst handleAvatarSuccess: UploadProps['onSuccess'] = (response, uploadFile) => {\r\n\tform.value.thumb = URL.createObjectURL(uploadFile.raw!);\r\n};\r\n\r\n</script>\r\n\r\n<style>\r\n.avatar-uploader .el-upload {\r\n\tborder: 1px dashed var(--el-border-color);\r\n\tborder-radius: 6px;\r\n\tcursor: pointer;\r\n\tposition: relative;\r\n\toverflow: hidden;\r\n\ttransition: var(--el-transition-duration-fast);\r\n}\r\n\r\n.avatar-uploader .el-upload:hover {\r\n\tborder-color: var(--el-color-primary);\r\n}\r\n\r\n.el-icon.avatar-uploader-icon {\r\n\tfont-size: 28px;\r\n\tcolor: #8c939d;\r\n\twidth: 178px;\r\n\theight: 178px;\r\n\ttext-align: center;\r\n}\r\n</style>\r\n","<template>\r\n\t<el-descriptions :title=\"title\" :column=\"column\" border>\r\n\t\t<el-descriptions-item v-for=\"item in list\" :span=\"item.span\">\r\n\t\t\t<template #label> {{ item.label }} </template>\r\n\t\t\t<slot :name=\"item.prop\" :rows=\"row\">\r\n\t\t\t\t{{ item.value || row[item.prop] }}\r\n\t\t\t</slot>\r\n\t\t</el-descriptions-item>\r\n\t</el-descriptions>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nconst props = defineProps({\r\n\tdata: {\r\n\t\ttype: Object,\r\n\t\trequired: true,\r\n\t}\r\n});\r\nconst { row, title, column = 2, list } = props.data;\r\n\r\n</script>\r\n"],"names":["options","formData","edit","update","__props","form","ref","rules","item","acc","cur","formRef","saveEdit","formEl","valid","handleAvatarSuccess","response","uploadFile","props","row","title","column","list"],"mappings":"yvBA4CA,KAAA,CAAA,QAAAA,EAAA,SAAAC,EAAA,KAAAC,EAAA,OAAAC,CAAA,EAAAC,EAoBAC,EAAAC,EAAA,CAAA,GAAAJ,EAAAD,EAAA,CAAA,CAAA,CAAA,EAEAM,EAAAP,EAAA,KAAA,IAAAQ,GACCA,EAAA,SACC,CAAA,CAAAA,EAAA,MAAA,CAAA,CAAA,SAAA,GAAA,QAAA,GAAAA,EAAA,gCAAA,QAAA,MAAA,CAAA,GAED,EAAQ,EAAA,OAAA,CAAAC,EAAAC,KAAA,CAAA,GAAAD,EAAA,GAAAC,CAAA,GAAA,CAAA,CAAA,EAITC,EAAAL,IACAM,EAAAC,GAAA,CACC,CAAAA,GACAA,EAAA,SAAAC,GAAA,CACC,GAAA,CAAAA,EAAY,MAAA,GACZX,EAAAE,EAAA,KAAA,CAAiB,CAAA,CACjB,EAGFU,EAAA,CAAAC,EAAAC,IAAA,CACCZ,EAAA,MAAA,MAAA,IAAA,gBAAAY,EAAA,GAAA,CAAsD,wyECxEvD,MAAAC,EAAAd,EAMA,CAAA,IAAAe,EAAA,MAAAC,EAAA,OAAAC,EAAA,EAAA,KAAAC,CAAA,EAAAJ,EAAA"}
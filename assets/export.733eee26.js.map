{"version":3,"file":"export.733eee26.js","sources":["../../src/views/table/export.vue"],"sourcesContent":["<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nexport default defineComponent({\n  name: 'export',\n})\n</script>\n<template>\r\n    <div>\r\n        <div class=\"container\">\r\n            <div class=\"handle-box\">\r\n                <el-button type=\"primary\" @click=\"exportXlsx\">导出Excel</el-button>\r\n            </div>\r\n            <el-table :data=\"tableData\" border class=\"table\" header-cell-class-name=\"table-header\">\r\n                <el-table-column prop=\"id\" label=\"ID\" width=\"55\" align=\"center\"></el-table-column>\r\n                <el-table-column prop=\"name\" label=\"姓名\"></el-table-column>\r\n                <el-table-column prop=\"sno\" label=\"学号\"></el-table-column>\r\n                <el-table-column prop=\"class\" label=\"班级\"></el-table-column>\r\n                <el-table-column prop=\"age\" label=\"年龄\"></el-table-column>\r\n                <el-table-column prop=\"sex\" label=\"性别\"></el-table-column>\r\n            </el-table>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\" name=\"export\">\r\nimport { ref } from 'vue';\r\nimport * as XLSX from 'xlsx';\r\n\r\ninterface TableItem {\r\n    id: number;\r\n    name: string;\r\n    sno: string;\r\n    class: string;\r\n    age: string;\r\n    sex: string;\r\n}\r\n\r\nconst tableData = ref<TableItem[]>([]);\r\n// 获取表格数据\r\nconst getData = () => {\r\n    tableData.value = [\r\n        {\r\n            id: 1,\r\n            name: '小明',\r\n            sno: 'S001',\r\n            class: '一班',\r\n            age: '10',\r\n            sex: '男',\r\n        },\r\n        {\r\n            id: 2,\r\n            name: '小红',\r\n            sno: 'S002',\r\n            class: '一班',\r\n            age: '9',\r\n            sex: '女',\r\n        },\r\n    ];\r\n};\r\ngetData();\r\n\r\nconst list = [['序号', '姓名', '学号', '班级', '年龄', '性别']];\r\nconst exportXlsx = () => {\r\n    tableData.value.map((item: any, i: number) => {\r\n        const arr: any[] = [i + 1];\r\n        arr.push(...[item.name, item.sno, item.class, item.age, item.sex]);\r\n        list.push(arr);\r\n    });\r\n    let WorkSheet = XLSX.utils.aoa_to_sheet(list);\r\n    let new_workbook = XLSX.utils.book_new();\r\n    XLSX.utils.book_append_sheet(new_workbook, WorkSheet, '第一页');\r\n    XLSX.writeFile(new_workbook, `表格.xlsx`);\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.handle-box {\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.handle-select {\r\n    width: 120px;\r\n}\r\n\r\n.handle-input {\r\n    width: 300px;\r\n}\r\n\r\n.table {\r\n    width: 100%;\r\n    font-size: 14px;\r\n}\r\n\r\n.red {\r\n    color: #f56c6c;\r\n}\r\n\r\n.table-td-thumb {\r\n    display: block;\r\n    margin: auto;\r\n    width: 40px;\r\n    height: 40px;\r\n}\r\n</style>\r\n"],"names":["__default__","defineComponent","tableData","ref","list","exportXlsx","item","i","arr","WorkSheet","XLSX.utils","new_workbook","XLSX.writeFile"],"mappings":"mWAEAA,EAAAC,EAAA,CAA+B,KAAA,QAE/B,CAAA,qBAiCA,MAAAC,EAAAC,EAAA,CAAA,CAAA,GAEA,IAAA,CACID,EAAA,MAAA,CAAkB,CACd,GAAA,EACQ,KAAA,eACE,IAAA,OACD,MAAA,eACE,IAAA,KACF,IAAA,QACA,EACT,CACA,GAAA,EACQ,KAAA,eACE,IAAA,OACD,MAAA,eACE,IAAA,IACF,IAAA,QACA,CACT,CACJ,KAIJ,MAAAE,EAAA,CAAA,CAAA,eAAA,eAAA,eAAA,eAAA,eAAA,cAAA,CAAA,EACAC,EAAA,IAAA,CACIH,EAAA,MAAA,IAAA,CAAAI,EAAAC,IAAA,CACI,MAAAC,EAAA,CAAAD,EAAA,CAAA,EACAC,EAAA,KAAAF,EAAA,KAAAA,EAAA,IAAAA,EAAA,MAAAA,EAAA,IAAAA,EAAA,GAAA,EACAF,EAAA,KAAAI,CAAA,CAAa,CAAA,EAEjB,IAAAC,EAAAC,EAAA,aAAAN,CAAA,EACAO,EAAAD,EAAA,WACAA,EAAA,kBAAAC,EAAAF,EAAA,oBAAA,EACAG,EAAAD,EAAA,mBAAA,CAAsC"}
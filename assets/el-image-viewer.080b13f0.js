import{aM as Ie,l as me,m as H,G as pe,T as ce,d as ne,cx as ve,cy as _e,cz as ze,v as ge,u as ye,bR as Le,r as b,cA as Ce,av as Ee,b as g,I as ue,n as we,e as be,o as w,y as de,g as f,z as L,f as y,L as v,B as e,a8 as fe,a9 as Se,M as C,C as O,b2 as xe,c as N,J as te,U as Ne,V as Oe,cB as Te,c8 as Ae,A as $e,cC as Re,cD as Ve,K as Be,a7 as Me,ab as De,q as ae,ac as Ye,bW as Xe,D as he,E as R,aw as V,cE as Fe,Z as ke,az as Pe,ad as P,x as He,aK as Ke,al as We,ae as je,cF as Ze}from"./index.01ea98cf.js";import{d as qe}from"./debounce.cb4df02e.js";import{u as Ge}from"./index.a8710ac8.js";import{i as Ue}from"./position.c23ddadf.js";import{a as Je}from"./scroll.07f4ce89.js";var Qe="Expected a function";function ie(d,_,l){var E=!0,o=!0;if(typeof d!="function")throw new TypeError(Qe);return Ie(l)&&(E="leading"in l?!!l.leading:E,o="trailing"in l?!!l.trailing:o),qe(d,_,{leading:E,maxWait:_,trailing:o})}const ea=me({urlList:{type:H(Array),default:()=>pe([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:H(String)}}),aa={close:()=>!0,switch:d=>ce(d),rotate:d=>ce(d)},ta=["src","crossorigin"],na=ne({name:"ElImageViewer"}),sa=ne({...na,props:ea,emits:aa,setup(d,{expose:_,emit:l}){var E;const o=d,p={CONTAIN:{name:"contain",icon:ve(_e)},ORIGINAL:{name:"original",icon:ve(ze)}},{t:se}=ge(),i=ye("image-viewer"),{nextZIndex:B}=Le(),S=b(),x=b([]),T=Ce(),h=b(!0),c=b(o.initialIndex),A=Ee(p.CONTAIN),s=b({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),M=b((E=o.zIndex)!=null?E:B()),le=g(()=>{const{urlList:t}=o;return t.length<=1}),K=g(()=>c.value===0),W=g(()=>c.value===o.urlList.length-1),D=g(()=>o.urlList[c.value]),oe=g(()=>[i.e("btn"),i.e("prev"),i.is("disabled",!o.infinite&&K.value)]),j=g(()=>[i.e("btn"),i.e("next"),i.is("disabled",!o.infinite&&W.value)]),Y=g(()=>{const{scale:t,deg:n,offsetX:r,offsetY:k,enableTransition:z}=s.value;let m=r/t,I=k/t;switch(n%360){case 90:case-270:[m,I]=[I,-m];break;case 180:case-180:[m,I]=[-m,-I];break;case 270:case-90:[m,I]=[-I,m];break}const $={transform:`scale(${t}) rotate(${n}deg) translate(${m}px, ${I}px)`,transition:z?"transform .3s":""};return A.value.name===p.CONTAIN.name&&($.maxWidth=$.maxHeight="100%"),$});function X(){Z(),l("close")}function re(){const t=ie(r=>{switch(r.code){case R.esc:o.closeOnPressEscape&&X();break;case R.space:Q();break;case R.left:ee();break;case R.up:u("zoomIn");break;case R.right:a();break;case R.down:u("zoomOut");break}}),n=ie(r=>{const k=r.deltaY||r.deltaX;u(k<0?"zoomIn":"zoomOut",{zoomRate:o.zoomRate,enableTransition:!1})});T.run(()=>{V(document,"keydown",t),V(document,"wheel",n)})}function Z(){T.stop()}function q(){h.value=!1}function G(t){h.value=!1,t.target.alt=se("el.image.error")}function U(t){if(h.value||t.button!==0||!S.value)return;s.value.enableTransition=!1;const{offsetX:n,offsetY:r}=s.value,k=t.pageX,z=t.pageY,m=ie($=>{s.value={...s.value,offsetX:n+$.pageX-k,offsetY:r+$.pageY-z}}),I=V(document,"mousemove",m);V(document,"mouseup",()=>{I()}),t.preventDefault()}function J(){s.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Q(){if(h.value)return;const t=Fe(p),n=Object.values(p),r=A.value.name,z=(n.findIndex(m=>m.name===r)+1)%t.length;A.value=p[t[z]],J()}function F(t){const n=o.urlList.length;c.value=(t+n)%n}function ee(){K.value&&!o.infinite||F(c.value-1)}function a(){W.value&&!o.infinite||F(c.value+1)}function u(t,n={}){if(h.value)return;const{minScale:r,maxScale:k}=o,{zoomRate:z,rotateDeg:m,enableTransition:I}={zoomRate:o.zoomRate,rotateDeg:90,enableTransition:!0,...n};switch(t){case"zoomOut":s.value.scale>r&&(s.value.scale=Number.parseFloat((s.value.scale/z).toFixed(3)));break;case"zoomIn":s.value.scale<k&&(s.value.scale=Number.parseFloat((s.value.scale*z).toFixed(3)));break;case"clockwise":s.value.deg+=m,l("rotate",s.value.deg);break;case"anticlockwise":s.value.deg-=m,l("rotate",s.value.deg);break}s.value.enableTransition=I}return ue(D,()=>{we(()=>{const t=x.value[0];t!=null&&t.complete||(h.value=!0)})}),ue(c,t=>{J(),l("switch",t)}),be(()=>{var t,n;re(),(n=(t=S.value)==null?void 0:t.focus)==null||n.call(t)}),_({setActiveItem:F}),(t,n)=>(w(),de(Xe,{to:"body",disabled:!t.teleported},[f(Ye,{name:"viewer-fade",appear:""},{default:L(()=>[y("div",{ref_key:"wrapper",ref:S,tabindex:-1,class:v(e(i).e("wrapper")),style:fe({zIndex:M.value})},[y("div",{class:v(e(i).e("mask")),onClick:n[0]||(n[0]=Se(r=>t.hideOnClickModal&&X(),["self"]))},null,2),C(" CLOSE "),y("span",{class:v([e(i).e("btn"),e(i).e("close")]),onClick:X},[f(e(O),null,{default:L(()=>[f(e(xe))]),_:1})],2),C(" ARROW "),e(le)?C("v-if",!0):(w(),N(te,{key:0},[y("span",{class:v(e(oe)),onClick:ee},[f(e(O),null,{default:L(()=>[f(e(Ne))]),_:1})],2),y("span",{class:v(e(j)),onClick:a},[f(e(O),null,{default:L(()=>[f(e(Oe))]),_:1})],2)],64)),C(" ACTIONS "),y("div",{class:v([e(i).e("btn"),e(i).e("actions")])},[y("div",{class:v(e(i).e("actions__inner"))},[f(e(O),{onClick:n[1]||(n[1]=r=>u("zoomOut"))},{default:L(()=>[f(e(Te))]),_:1}),f(e(O),{onClick:n[2]||(n[2]=r=>u("zoomIn"))},{default:L(()=>[f(e(Ae))]),_:1}),y("i",{class:v(e(i).e("actions__divider"))},null,2),f(e(O),{onClick:Q},{default:L(()=>[(w(),de($e(e(A).icon)))]),_:1}),y("i",{class:v(e(i).e("actions__divider"))},null,2),f(e(O),{onClick:n[3]||(n[3]=r=>u("anticlockwise"))},{default:L(()=>[f(e(Re))]),_:1}),f(e(O),{onClick:n[4]||(n[4]=r=>u("clockwise"))},{default:L(()=>[f(e(Ve))]),_:1})],2)],2),C(" CANVAS "),y("div",{class:v(e(i).e("canvas"))},[(w(!0),N(te,null,Be(t.urlList,(r,k)=>Me((w(),N("img",{ref_for:!0,ref:z=>x.value[k]=z,key:r,src:r,style:fe(e(Y)),class:v(e(i).e("img")),crossorigin:t.crossorigin,onLoad:q,onError:G,onMousedown:U},null,46,ta)),[[De,k===c.value]])),128))],2),ae(t.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var la=he(sa,[["__file","image-viewer.vue"]]);const oa=ke(la),ra=me({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:H([String,Object])},previewSrcList:{type:H(Array),default:()=>pe([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:H(String)}}),ia={load:d=>d instanceof Event,error:d=>d instanceof Event,switch:d=>ce(d),close:()=>!0,show:()=>!0},ca=["src","loading","crossorigin"],ua={key:0},da=ne({name:"ElImage",inheritAttrs:!1}),fa=ne({...da,props:ra,emits:ia,setup(d,{emit:_}){const l=d;let E="";const{t:o}=ge(),p=ye("image"),se=Pe(),i=Ge(),B=b(),S=b(!1),x=b(!0),T=b(!1),h=b(),c=b(),A=P&&"loading"in HTMLImageElement.prototype;let s,M;const le=g(()=>[p.e("inner"),D.value&&p.e("preview"),x.value&&p.is("loading")]),K=g(()=>se.style),W=g(()=>{const{fit:a}=l;return P&&a?{objectFit:a}:{}}),D=g(()=>{const{previewSrcList:a}=l;return Array.isArray(a)&&a.length>0}),oe=g(()=>{const{previewSrcList:a,initialIndex:u}=l;let t=u;return u>a.length-1&&(t=0),t}),j=g(()=>l.loading==="eager"?!1:!A&&l.loading==="lazy"||l.lazy),Y=()=>{!P||(x.value=!0,S.value=!1,B.value=l.src)};function X(a){x.value=!1,S.value=!1,_("load",a)}function re(a){x.value=!1,S.value=!0,_("error",a)}function Z(){Ue(h.value,c.value)&&(Y(),U())}const q=Ze(Z,200,!0);async function G(){var a;if(!P)return;await we();const{scrollContainer:u}=l;We(u)?c.value=u:je(u)&&u!==""?c.value=(a=document.querySelector(u))!=null?a:void 0:h.value&&(c.value=Je(h.value)),c.value&&(s=V(c,"scroll",q),setTimeout(()=>Z(),100))}function U(){!P||!c.value||!q||(s==null||s(),c.value=void 0)}function J(a){if(!!a.ctrlKey){if(a.deltaY<0)return a.preventDefault(),!1;if(a.deltaY>0)return a.preventDefault(),!1}}function Q(){!D.value||(M=V("wheel",J,{passive:!1}),E=document.body.style.overflow,document.body.style.overflow="hidden",T.value=!0,_("show"))}function F(){M==null||M(),document.body.style.overflow=E,T.value=!1,_("close")}function ee(a){_("switch",a)}return ue(()=>l.src,()=>{j.value?(x.value=!0,S.value=!1,U(),G()):Y()}),be(()=>{j.value?G():Y()}),(a,u)=>(w(),N("div",{ref_key:"container",ref:h,class:v([e(p).b(),a.$attrs.class]),style:fe(e(K))},[S.value?ae(a.$slots,"error",{key:0},()=>[y("div",{class:v(e(p).e("error"))},He(e(o)("el.image.error")),3)]):(w(),N(te,{key:1},[B.value!==void 0?(w(),N("img",Ke({key:0},e(i),{src:B.value,loading:a.loading,style:e(W),class:e(le),crossorigin:a.crossorigin,onClick:Q,onLoad:X,onError:re}),null,16,ca)):C("v-if",!0),x.value?(w(),N("div",{key:1,class:v(e(p).e("wrapper"))},[ae(a.$slots,"placeholder",{},()=>[y("div",{class:v(e(p).e("placeholder"))},null,2)])],2)):C("v-if",!0)],64)),e(D)?(w(),N(te,{key:2},[T.value?(w(),de(e(oa),{key:0,"z-index":a.zIndex,"initial-index":e(oe),infinite:a.infinite,"zoom-rate":a.zoomRate,"min-scale":a.minScale,"max-scale":a.maxScale,"url-list":a.previewSrcList,"hide-on-click-modal":a.hideOnClickModal,teleported:a.previewTeleported,"close-on-press-escape":a.closeOnPressEscape,onClose:F,onSwitch:ee},{default:L(()=>[a.$slots.viewer?(w(),N("div",ua,[ae(a.$slots,"viewer")])):C("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):C("v-if",!0)],64)):C("v-if",!0)],6))}});var va=he(fa,[["__file","image.vue"]]);const ba=ke(va);export{ba as E,ie as t};
